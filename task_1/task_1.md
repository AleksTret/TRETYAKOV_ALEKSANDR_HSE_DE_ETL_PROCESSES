# Домашнее задание Практическая работа Дисциплина «ETL- процессы»
Тема «Источники данных»

**Выполнил - Третьяков Александр Юрьевич**

### Задание
Форма проверки - 
Самостоятельное задание с разбором на вебинаре.

Совет: выполняйте домашнее задание сразу, как только изучите тему.

Имя преподавателя
Артём Озерков

Время выполнения
120 минут

Цель задания
- Практика чтения сложного формата данных
- Инструменты для выполнения ДЗ
- Apache Airflow.

Правила приёма работы

Прикрепите в LMS ссылку на GitHub с выполненным заданием и скриншот из
Аirflow, чтобы был виден успешно завершившийся процесс.

Важно:
- убедитесь, что по ссылке есть доступ;
- название должно содержать фамилию и имя студента, номер и название
ДЗ.

Чек-лист самопроверки

Задание считается выполненным, если:
- прикреплена ссылка с выполненным заданием;
- по ссылке содержится выполненное задание;
- доступ к материалам открыт.

Дедлайн
6 дней после открытия задания на платформе
Описание задания

Приведите следующие сложные форматы к линейной структуре:
- JSON (ссылка)
- *XML (ссылка) (задание дополнительное, повышенной сложности)

<div style="page-break-after: always;"></div>

### Решение

Используя `docker-compose.yml` файл выполним развертывание

<img src="./assets/2026-01-27 123817.jpg" width="700">

### Первая часть задания (работа с JSON)

"Сырые" json данные были записаны в таблицу `raw_pets_json` при развертывании

```json
INSERT INTO raw_pets_json (json_data) 
VALUES ('{
  "pets": [
    {
      "name": "Purrsloud",
      "species": "Cat",
      "favFoods": ["wet food", "dry food", "<strong>any</strong> food"],
      "birthYear": 2016,
      "photo": "https://learnwebcode.github.io/json-example/images/cat-2.jpg"
    },
    {
      "name": "Barksalot",
      "species": "Dog",
      "birthYear": 2008,
      "photo": "https://learnwebcode.github.io/json-example/images/dog-1.jpg"
    },
    {
      "name": "Meowsalot",
      "species": "Cat",
      "favFoods": ["tuna", "catnip", "celery"],
      "birthYear": 2012,
      "photo": "https://learnwebcode.github.io/json-example/images/cat-1.jpg"
    }
  ]
}');
```

Нам необходимо "сырые" данные из таблицы `raw_pets_json` используя `DAG` перевести в "плоскую" форму в таблицу `pets_flat`

Проверим что в таблице `raw_pets_json` есть данные, а таблица пуста `pets_flat`.

<img src="./assets/2026-01-27 124404.jpg" width="700">

<img src="./assets/2026-01-27 124342.jpg" width="700">

<img src="./assets/2026-01-27 124428.jpg" width="700">

Подключимся к `Airflow` и запустим на выполнение `DAG`

<img src="./assets/2026-01-27 124727.jpg" width="700">

<img src="./assets/2026-01-27 134219.jpg" width="700">

DAG успешно выполнен

<img src="./assets/2026-01-27 134132.jpg" width="700">

Проверим содержимое таблицы `pets_flat`

<img src="./assets/2026-01-27 134517.jpg" width="700">

На этом первая часть задания выполнена.


### Вторая часть задания (работа с XML)

"Сырые" `xml` данные были записаны в таблицу `raw_nutrition_xml` при развертывании

Проверим что они есть и проверим что таблица пуста.

<img src="./assets/2026-01-27 145612.jpg" width="700">

<img src="./assets/2026-01-27 145509.jpg" width="700">

Зайдем в airflow и запустим `DAG`

<img src="./assets/2026-01-27 151726.jpg" width="700">

<img src="./assets/2026-01-27 151801.jpg" width="700">

<img src="./assets/2026-01-27 151832.jpg" width="700">

Проверим содержимое двух таблиц с "плоскими" данными

<img src="./assets/2026-01-27 153923.jpg" width="700">

<img src="./assets/2026-01-27 154006.jpg" width="700">

На этом вторая часть задания выполнена.